!function(){"use strict";jQuery(document).ready((function(){const t=jQuery,{ajaxurl:e,nonce:a}=devnet_biznotes_ajax;async function s(s="",d={},n="get"){if(!s)return!1;let i;try{i=await t.ajax({type:n,url:e,data:{action:s,args:d,security:a}})}catch(t){console.error("ERROR: ",t)}return i}const d=(e,a)=>{const s=t(`a.order-preview[data-order-id=${e}]`).data("order-data");let d=t(`tr#order-${e}`);0===d.length&&(d=t(`tr#post-${e}`)),a.add&&(s.biznotes={...s.biznotes,...a.add}),a.delete&&delete s.biznotes[a.delete],Object.keys(s.biznotes).length?d.addClass("has-biznotes"):d.removeClass("has-biznotes")};t(document).on("click",".add-biznote",(async function(e){e.preventDefault();const a=t(this).closest(".biznotes-wrap").find(".biznotes-list"),n=t(this).siblings(".biznote-input"),i=n.val(),o=t(this).data("order-id");if(!i)return!1;t(this).addClass("disabled");const r=await s("submit_biznotes",{note:i,orderId:o},"post");if("success"===r.status){n.val("");const t=`\n\t\t\t<div class="biznote flash--new">\n\t\t\t\t<span class="delete-biznote" data-id="${r.data.id}" data-order-id="${r.data.order_id}">&times</span>\n\t\t\t\t<div class="biznote-meta">\n\t\t\t\t\t<small class="biznote-author">${r.data.user}</small>\n\t\t\t\t\t<small class="biznote-date">${r.data.date}</small>\n\t\t\t\t</div>\n\t\t\t\t<p class="biznote-message">${r.data.note}</p>\n\t\t\t</div>`;a.append(t);const e={[r.data.id]:r.data};d(o,{add:e})}t(this).removeClass("disabled")})),t(document).on("click",".delete-biznote",(async function(e){e.preventDefault();const a=t(this).data("id"),n=t(this).data("order-id"),i=t(this).closest(".biznote");await s("delete_biznotes",{id:a,orderId:n},"post"),i.addClass("flash--delete"),i.fadeOut(1200,(function(){t(this).remove()})),d(n,{delete:a})}))}))}();